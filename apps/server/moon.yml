$schema: 'https://moonrepo.dev/schemas/project.json'

language: 'rust'
type: 'application'

project:
  name: 'server'
  description: 'Rust/Axum backend server for Ascension'

tasks:
  build:
    command: 'cargo'
    args: ['build']
    inputs:
      - 'src/**/*'
      - 'Cargo.toml'
      - 'Cargo.lock'

  build-release:
    command: 'cargo'
    args: ['build', '--release']
    inputs:
      - 'src/**/*'
      - 'Cargo.toml'
      - 'Cargo.lock'

  dev:
    command: 'cargo'
    args: ['run']
    local: true
    deps:
      - 'build'

  test:
    command: 'cargo'
    args: ['test']
    inputs:
      - 'src/**/*'
      - 'Cargo.toml'

  lint:
    command: 'cargo'
    args: ['clippy', '--', '-D', 'warnings']
    inputs:
      - 'src/**/*'
      - 'Cargo.toml'

  format:
    command: 'cargo'
    args: ['fmt', '--check']
